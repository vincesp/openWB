(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{217:function(e,t,r){var content=r(226);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(82).default)("8da5bbd6",content,!0,{sourceMap:!1})},218:function(e,t,r){var content=r(228);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(82).default)("1ffe32f5",content,!0,{sourceMap:!1})},219:function(e,t,r){var content=r(230);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(82).default)("bfa9fc46",content,!0,{sourceMap:!1})},220:function(e,t,r){var content=r(232);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(82).default)("6df1110e",content,!0,{sourceMap:!1})},221:function(e,t,r){var content=r(236);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(82).default)("0ace817b",content,!0,{sourceMap:!1})},225:function(e,t,r){"use strict";var n=r(217);r.n(n).a},226:function(e,t,r){(t=r(81)(!1)).push([e.i,".value-area{text-align:center}.value-area .title{font-size:1.5rem;line-height:1em;margin:0 0 5px}.value-area .values{display:grid;grid-auto-flow:column;grid-auto-columns:auto;grid-gap:5px;gap:5px}",""]),e.exports=t},227:function(e,t,r){"use strict";var n=r(218);r.n(n).a},228:function(e,t,r){(t=r(81)(!1)).push([e.i,".color-green{color:#24db7c}.color-yellow{color:#ebe914}.color-red{color:#ff3500}.color-purple{color:#ff00f8}.color-white{color:#fff}.live-value{text-align:center}.big-value{display:inline-block;position:relative}.big-value .space-measure{visibility:hidden}.big-value .display-value{position:absolute;right:0;top:0}.value-label{height:1.1em}",""]),e.exports=t},229:function(e,t,r){"use strict";var n=r(219);r.n(n).a},230:function(e,t,r){(t=r(81)(!1)).push([e.i,".toggle{display:inline-flex;justify-content:center;align-items:center;position:relative;padding:0 2.125rem;min-height:4.25rem;box-sizing:border-box}.toggle .toggle__indicator{position:absolute;bottom:.25rem;border:2px solid var(--color-accent);background-color:var(--color-accent-25);height:.5rem;width:2rem;border-radius:.25rem;box-sizing:border-box}.toggle.selected .toggle__indicator{border:1px solid var(--color-accent-p10);background-color:var(--color-accent)}",""]),e.exports=t},231:function(e,t,r){"use strict";var n=r(220);r.n(n).a},232:function(e,t,r){var n=r(81),o=r(149),l=r(233),c=r(234);t=n(!1);var v=o(l),d=o(c);t.push([e.i,'.value-bar{--track-height:1.5rem;--bar-color:#fff;color:var(--bar-color);position:relative}.value-bar .bar{height:var(--track-height);position:absolute}.value-bar .track{background-color:#474747;width:100%}.value-bar .filled{background-color:var(--bar-color)}.value-bar .filled:after{position:absolute;top:var(--track-height);height:1.875rem;left:0;right:0;content:"";background-size:100% 100%;background-image:url('+v+")}.value-bar .value{text-align:right;margin-top:var(--track-height)}.value-bar.interactive{--bar-color:var(--color-accent)}.value-bar.interactive .track{display:none}.value-bar.interactive .filled{bottom:0}.value-bar.interactive .filled:after{top:auto;bottom:var(--track-height);background-image:url("+d+")}.value-bar.interactive .value{margin-top:0;margin-bottom:var(--track-height)}.value-bar.compact{--track-height:.25rem}.selected .value-bar .track{background-color:#000}",""]),e.exports=t},233:function(e,t,r){e.exports=r.p+"img/91724a6.png"},234:function(e,t,r){e.exports=r.p+"img/ea00795.png"},235:function(e,t,r){"use strict";var n=r(221);r.n(n).a},236:function(e,t,r){(t=r(81)(!1)).push([e.i,".container{position:fixed;display:grid;grid-template-columns:1fr;grid-template-rows:-webkit-max-content auto -webkit-max-content;grid-template-rows:max-content auto max-content;width:100%;height:100%;grid-gap:10px;gap:10px}.value-display{grid-auto-columns:auto}.charger-container,.value-display{display:grid;grid-auto-flow:column;grid-gap:10px;gap:10px}.charger-container{grid-template-rows:1fr;grid-auto-columns:1fr}.charger{display:grid;grid-auto-flow:row;grid-gap:10px;gap:10px;grid-template-columns:1fr 1fr;grid-auto-rows:auto;align-content:center}.span-row{grid-column:1/-1}.buttonbar{display:grid;grid-auto-flow:column;grid-auto-columns:1fr}.buttonbar>:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.buttonbar>:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.toggle-label{text-align:center;width:100%;position:absolute;bottom:1rem}.soc-slider{width:100%;height:5rem;position:relative}.soc-slider .current-value,.soc-slider .target-value{position:absolute;left:0;right:0}.soc-slider .target-value{top:.25rem}.soc-slider .current-value{bottom:.25rem}",""]),e.exports=t},238:function(e,t,r){"use strict";r.r(t);r(216),r(20);var n=r(4),o=r(17),l=(r(25),r(13),r(148),r(37)),c=r(239),v=r(224),d=r.n(v),h=r(1);function m(e,t){return function(){return{topic:e,defaultValue:t,transform:function(e){return e}}}}function f(e,t){console.log("mqtt",e,t);var r=new d.a.Client(e,t,Object(c.a)()),n=[],v={},f={};function y(e,t,r){if(t)if(Array.isArray(t))for(var i=0;i<t.length;++i)r(i,t[i]);else if("object"===Object(l.a)(t))for(var n=0,c=Object.entries(t);n<c.length;n++){var v=Object(o.a)(c[n],2);r(v[0],v[1])}}function x(e,data,t){y(0,e,(function(e,n){var o=n;switch(Object(l.a)(n)){case"string":o=t(n);case"function":var c=o(),d=c.topic,m=c.transform;!function(e,t){v[e]&&console.warn("Overriding topic",e),t?(v[e]=t,r.subscribe(e)):(delete v[e],r.unsubscribe(t))}(d,(function(t){return h.a.set(data,e,m(t))}));break;default:x(n,data[e],t)}}))}function C(e,t){y(0,t,(function(t,r){if("string"!=typeof r)if("function"!=typeof r)e[t]=e[t]||(Array.isArray(r)?[]:{}),C(e[t],r);else{var n=r().defaultValue;void 0!==n&&(e[t]=n)}}))}function _(){if(r.isConnected())for(;n.length;){var e=n.shift();x(e.subscriptionMap,e.data,e.defaultConfig)}}function w(e,t){var n=new d.a.Message("".concat(t));n.destinationName=e,console.log("out",e,t),r.send(n)}return r.onConnectionLost=function(e){console.error("MQTT connection lost",e)},r.onMessageArrived=function(e){console.log("in",e.destinationName,e.payloadString);try{v[e.destinationName](e.payloadString)}catch(e){console.log(e)}},r.connect({onSuccess:function(){console.log("MQTT connected"),_()}}),{methods:{$mqttRegisterSubscriptions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m,data={};return C(data,e),n.push({subscriptionMap:e,data:data,defaultConfig:t}),_(),data},$mqttSendMessage:w,$mqttSetValue:function(e,t){f[e]||(f[e]={}),f[e].lastValue=t,this.$nextTick((function(){return function(e){var t=f[e];t&&(w(e,t.lastValue),delete f[e])}(e)}))}},destroyed:function(){r.disconnect()}}}f.String=m,f.Boolean=function(e,t){return function(){return{topic:e,defaultValue:t,transform:function(e){return!!Number(e)}}}},f.Number=function(e,t){return function(){return{topic:e,defaultValue:t,transform:function(e){return Number(e)}}}};var y=f,x={props:{title:String}},C=(r(225),r(44)),_=Object(C.a)(x,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"value-area"},[t("h1",{staticClass:"title"},[this._v(this._s(this.title))]),this._v(" "),t("div",{staticClass:"values"},[this._t("default")],2)])}),[],!1,null,null,null).exports,w={props:{value:Number,templateValue:{type:Number,default:99999},minValue:Number,maxValue:Number,unit:String,negativLabel:String,positivLabel:String,zeroLabel:String,labelOverride:String,ranges:Object},computed:{displayValue:function(){return Math.abs(this.value||0)},label:function(){return this.labelOverride||(this.value<0?this.negativLabel:this.value>0?this.positivLabel:this.zeroLabel||"")},valueColorName:function(){var e="";if(this.ranges)for(var t=0,r=Object.entries(this.ranges);t<r.length;t++){var n=Object(o.a)(r[t],2),l=n[0],c=n[1],v=this.percentToNumber(c);if(v*this.value>0&&(100==c&&Math.abs(this.value)>Math.abs(v)&&(v=this.value),Math.abs(this.value)<=Math.abs(v))){if(e&&Math.abs(this.ranges[e])<Math.abs(c))continue;e=l}}return e}},methods:{percentToNumber:function(e){return e<0?-e/100*this.minValue:e/100*this.maxValue}}},k=(r(227),Object(C.a)(w,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"live-value",class:"color-"+e.valueColorName},[r("div",{staticClass:"big-value large-font"},[r("i18n-n",{staticClass:"space-measure",attrs:{value:e.templateValue},scopedSlots:e._u([{key:"group",fn:function(){return[e._v(" ")]},proxy:!0}])}),e._v(" "),r("i18n-n",{staticClass:"display-value",attrs:{value:e.displayValue},scopedSlots:e._u([{key:"group",fn:function(){return[e._v(" ")]},proxy:!0}])})],1),e._v("\n  "+e._s(e.unit)+"\n  "),e.label?r("div",{staticClass:"value-label"},[e._v(e._s(e.label))]):e._e()])}),[],!1,null,null,null).exports),S={props:{value:Boolean,enabled:{type:Boolean,default:!0}},methods:{onClick:function(){this.enabled&&this.$emit("input",!this.value)}}},W=(r(229),Object(C.a)(S,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"toggle",class:{selected:e.enabled&&e.value,toucharea:e.enabled,toucharea__item:e.enabled},on:{click:e.onClick}},[e._t("default"),e._v(" "),e.enabled?r("div",{staticClass:"toggle__indicator"}):e._e()],2)}),[],!1,null,null,null).exports),B={props:{value:Number,maxValue:Number,unit:String,interactive:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},computed:{filledBarStyle:function(){return{width:"".concat(this.value/this.maxValue*100,"%")}}}},M=(r(231),{components:{ValueArea:_,LiveValue:k,Toggle:W,ValueBar:Object(C.a)(B,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"value-bar",class:{interactive:e.interactive,compact:e.compact}},[r("div",{staticClass:"bar track"}),e._v(" "),r("div",{staticClass:"bar filled",style:e.filledBarStyle}),e._v(" "),r("div",{staticClass:"value"},[r("i18n-n",{staticClass:"large-font",attrs:{value:e.value},scopedSlots:e._u([{key:"group",fn:function(){return[e._v(" ")]},proxy:!0}])}),e._v(" "+e._s(e.unit)+"\n  ")],1)])}),[],!1,null,null,null).exports},mixins:[y(window.location.hostname,9001)],data:function(){return{actions:[{name:"chargeImmediate",id:0},{name:"pv1",id:1},{name:"pv2",id:2,prio:"car"},{name:"pv3",id:2,prio:"homeBattery"},{name:"standby",id:4},{name:"stop",id:3}],lastError:null,staticData:{},mqttData:this.$mqttRegisterSubscriptions({selectedChargeModeId:y.Number("openWB/global/ChargeMode",-1),houseConsumption:"openWB/global/WHouseConsumption",evu:{W:"openWB/evu/W"},pv:{W:"openWB/pv/W"},houseBattery:{W:"openWB/housebattery/W",soc:"openWB/housebattery/%Soc"},chargers:[1,2].map((function(i){return{name:y.String("openWB/lp/".concat(i,"/strChargePointName")),W:"openWB/lp/".concat(i,"/W"),soc:"openWB/lp/".concat(i,"/%Soc"),enabled:y.Boolean("openWB/lp/".concat(i,"/ChargePointEnabled")),actualCharged_kWh:"openWB/lp/".concat(i,"/kWhActualCharged"),phase1_A:"openWB/lp/".concat(i,"/APhase1"),phase2_A:"openWB/lp/".concat(i,"/APhase2"),phase3_A:"openWB/lp/".concat(i,"/APhase3"),energyConsumptionPer100km:"openWB/lp/".concat(i,"/energyConsumptionPer100km"),phasesInUseCount:"openWB/lp/".concat(i,"/countPhasesInUse"),current_A:"openWB/config/get/sofort/lp/".concat(i,"/current"),chargeLimitation:"openWB/config/get/sofort/lp/".concat(i,"/chargeLimitation"),energyToCharge:"openWB/config/get/sofort/lp/".concat(i,"/energyToCharge"),socToChargeTo:"openWB/config/get/sofort/lp/".concat(i,"/socToChargeTo")}}))},y.Number),activeSocSliderChargerIndex:-1,sliderSoc:0}},computed:{manualModeEnbled:function(){return 0==this.mqttData.selectedChargeModeId}},watch:{lastError:function(e){e&&console.error(e)}},mounted:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.refreshAllData();case 2:setInterval(Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.refreshAllData();case 2:case"end":return t.stop()}}),t)}))),36e5);case 3:case"end":return t.stop()}}),t)})))()},methods:{clickAction:function(e){this.$mqttSetValue("openWB/set/ChargeMode",e.id)},refreshAllData:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.lastError=null,t.next=4,e.$axios.$get("api/staticData.php");case 4:e.staticData=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e.lastError=t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},enableCharger:function(e,t){this.$mqttSetValue("openWB/set/lp".concat(e+1,"/ChargePointEnabled"),t?"1":"0")},setChargeLimitation:function(e,t){this.$mqttSetValue("openWB/config/set/sofort/lp/".concat(e+1,"/chargeLimitation"),t)},getDisplaySoc:function(e){return Number("displaySoc"in e?e.displaySoc:e.socToChargeTo)},socMouseEvent:function(e,t){var r=10*Math.round((t.pageX-t.currentTarget.getBoundingClientRect().x)/t.currentTarget.clientWidth*10);r>100&&(r=100),r<0&&(r=0);var n=this.mqttData.chargers[e];switch(t.type){case"mousedown":case"touchstart":this.setChargeLimitation(e,2),this.activeSocSliderChargerIndex=e;case"mousemove":case"touchmove":this.activeSocSliderChargerIndex===e&&this.$set(n,"displaySoc",r);break;case"mouseleave":case"mouseup":case"touchend":case"touchcancel":this.activeSocSliderChargerIndex===e&&(this.activeSocSliderChargerIndex=-1,this.$delete(n,"displaySoc"),"touchcancel"!=t.type&&(n.socToChargeTo=r,this.$mqttSetValue("openWB/config/set/sofort/lp/".concat(e+1,"/socToChargeTo"),r)))}},toggleChargeLimitation:function(e,t){var r=this.mqttData.chargers[e];this.setChargeLimitation(e,r.chargeLimitation==t?0:t)}}}),$=(r(235),Object(C.a)(M,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container",class:{error:!!e.lastError}},[r("div",{staticClass:"value-display"},[r("value-area",{attrs:{title:e.$t("values.pv")}},[r("live-value",{attrs:{value:-e.mqttData.pv.W,unit:"W",templateValue:e.staticData.displaypvmax,labelOverride:e.$t("values.pvProduction"),"min-value":0,"max-value":e.staticData.displaypvmax,ranges:{green:100,yellow:10}}})],1),e._v(" "),r("value-area",{attrs:{title:e.$t("values.houseConsumption")}},[r("live-value",{attrs:{value:e.mqttData.houseConsumption,unit:"W",templateValue:e.staticData.displayhausmax,labelOverride:e.$t("values.consumption"),"min-value":0,"max-value":e.staticData.displayhausmax}})],1),e._v(" "),r("value-area",{attrs:{title:e.$t("values.evu")}},[r("live-value",{attrs:{value:e.mqttData.evu.W,unit:"W",templateValue:e.staticData.displayevumax,positivLabel:e.$t("values.drawFromGrid"),negativLabel:e.$t("values.feedToGrid"),"min-value":-e.staticData.displayevumax,"max-value":e.staticData.displayevumax,ranges:{green:-100,yellow:40,red:100}}})],1),e._v(" "),r("value-area",{attrs:{title:e.$t("values.houseBattery")}},[r("live-value",{attrs:{value:e.mqttData.houseBattery.W,unit:"W",templateValue:e.staticData.displayspeichermax,positivLabel:e.$t("values.chargeBattery"),zeroLabel:e.$t("values.chargeBattery"),negativLabel:e.$t("values.dischargeBattery"),"min-value":-e.staticData.displayspeichermax,"max-value":e.staticData.displayspeichermax,ranges:{green:100,yellow:-10,red:-100}}}),e._v(" "),r("live-value",{attrs:{value:e.mqttData.houseBattery.soc,unit:"%",templateValue:100,labelOverride:e.$t("values.soc"),"min-value":0,"max-value":100,ranges:{green:100,yellow:10}}})],1)],1),e._v(" "),r("div",{staticClass:"charger-container"},e._l(e.mqttData.chargers,(function(t,i){return r("div",{key:i,staticClass:"charger"},[r("toggle",{staticClass:"span-row",attrs:{value:t.enabled},on:{input:function(t){return e.enableCharger(i,t)}}},[r("span",{staticClass:"large-font"},[e._v(e._s(t.name))])]),e._v(" "),r("toggle",{staticClass:"span-row",attrs:{enabled:e.manualModeEnbled,value:2==t.chargeLimitation}},[r("div",{staticClass:"soc-slider",on:{mousedown:function(t){return e.socMouseEvent(i,t)},mousemove:function(t){return e.socMouseEvent(i,t)},mouseup:function(t){return e.socMouseEvent(i,t)},mouseleave:function(t){return e.socMouseEvent(i,t)},touchstart:function(t){return e.socMouseEvent(i,t)},touchmove:function(t){return e.socMouseEvent(i,t)},touchend:function(t){return e.socMouseEvent(i,t)},touchcancel:function(t){return e.socMouseEvent(i,t)}}},[r("div",{staticClass:"toggle-label"},[e._v(e._s(e.$t("values.soc")))]),e._v(" "),e.manualModeEnbled?r("value-bar",{staticClass:"target-value",attrs:{value:e.getDisplaySoc(t),unit:"%","max-value":100,interactive:"",compact:""}}):e._e(),e._v(" "),r("value-bar",{staticClass:"current-value",attrs:{value:t.soc,unit:"%","max-value":100,compact:e.manualModeEnbled}})],1)]),e._v(" "),r("toggle",{attrs:{value:1==t.chargeLimitation},on:{input:function(t){return e.toggleChargeLimitation(i,1)}}},[e._v("kWh")])],1)})),0),e._v(" "),r("div",{staticClass:"buttonbar toucharea"},e._l(e.actions,(function(t){return r("button",{key:t.name,class:{selected:t.id==e.mqttData.selectedChargeModeId,toucharea__item:t.id!=e.mqttData.selectedChargeModeId},on:{click:function(r){return e.clickAction(t)}}},[e._v("\n      "+e._s(e.$t("actions."+t.name+".label"))+"\n      "),r("div",{staticClass:"small"},[e._v(e._s(e.$t("actions."+t.name+".description")))])])})),0)])}),[],!1,null,null,null));t.default=$.exports}}]);